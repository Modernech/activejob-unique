<style type="text/css">
  a.no-decoration:focus, a.no-decoration:hover {
    text-decoration: none;
  }
  form .btn {
    margin-right: 0;
  }
  .label-none {
    background: #eee;
    color: #999;
  }
</style>
<%
  def stats_label(value, style)
    if "#{value}" == "0"
      return "<span class='label label-none'>#{value}</span>"
    else
      return "<span class='label label-#{style}'>#{value}</span>"
    end
  end
%>
<header class='row'>
  <div class='col-sm-5 col-xs-12'>
    <h3>Job Stats</h3>
  </div>
</header>
<% if @job_stats.size > 0 %>
  <table class="table table-hover table-bordered table-striped table-white">
    <thead>
      <th>Queue</th>
      <th><%= stats_label('Uniqueness', 'warning') %></th>
      <th><%= stats_label('Skiped', 'default') %></th>
      <th><%= stats_label('Processing', 'info') %></th>
      <th><%= stats_label('Processed', 'success') %></th>
      <th><%= stats_label('Failed', 'danger') %></th>
      <th><%= stats_label('Attempted', 'primary') %></th>
      <th class="text-center" style="width:110px">Stage</th>
    </thead>
    <tbody>
      <% @job_stats.each do |job| %>
        <tr>
          <td rowspan="2"><%= job[:queue_name] %></td>
          <td rowspan="2">
            <a class="no-decoration" href="<%= root_path %>job_stats/uniqueness/<%= job[:queue_name] %>">
              <p>
                <%= stats_label(job[:uniqueness], 'warning') %>
                <p><br></p>
              </p>
            </a>
          </td>
          <td><%= stats_label(job[:today_enqueue_skiped], 'default') %></td>
          <td><%= job[:today_enqueue_processing] %></td>
          <td><%= job[:today_enqueue_processed] %></td>
          <td><%= stats_label(job[:today_enqueue_failed], 'danger') %></td>
          <td><%= stats_label(job[:today_enqueue_attempted], 'primary') %></td>
          <td class="text-center">
            <a class="no-decoration" href="<%= root_path %>job_stats/enqueue/<%= job[:queue_name] %>">
              <div>
              <%= stats_label('E', 'info') %>
              <%= stats_label('view jobs', 'default') %>
              </div>
            </a>
          </td>
        </tr>
        <tr>
          <td><%= stats_label(job[:today_perform_skiped], 'default') %></td>
          <td><%= job[:today_perform_processing] %></td>
          <td><%= job[:today_perform_processed] %></td>
          <td><%= stats_label(job[:today_perform_failed], 'danger') %></td>
          <td><%= stats_label(job[:today_perform_attempted], 'primary') %></td>
          <td class="text-center">
            <a class="no-decoration" href="<%= root_path %>job_stats/perform/<%= job[:queue_name] %>">
              <div>
              <%= stats_label('P', 'success') %>
              <%= stats_label('view jobs', 'default') %>
              </div>
            </a>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
<% else %>
  <div class='alert alert-success'>No queue found in sidekiq</div>
<% end %>
